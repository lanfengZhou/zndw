$(function(){$("#gpsobjList").jqGrid({url:"/gpsobj/query",datatype:"json",colNames:["定位对象类型","定位对象别名","是否绑定GPS","绑定GPS识别码","添加时间","编辑"],colModel:[{name:"typeName",index:"typeName",width:50,align:"center",editable:!0,editrules:{required:!0},editoptions:{readonly:!0}},{name:"alias",index:"alias",width:50,align:"center",editable:!0},{name:"state",index:"state",width:50,align:"center",editable:!0,editoptions:{readonly:!0}},{name:"number",index:"number",width:50,align:"center",editable:!0,editoptions:{readonly:!0}},{name:"insertTime",index:"insertTime",width:50,align:"center",editable:!1,editoptions:{readonly:!0}},{name:"action",index:"act",width:100,align:"center",sortable:!1}],jsonReader:{root:"gpsobj",records:"total",total:"pages"},rowNum:10,rowList:[10,20,30],pager:"#objPager",mtype:"post",viewrecords:!0,caption:"定位对象管理",rownumbers:!0,rownumWidth:40,gridComplete:function(){for(var e=$("#gpsobjList").jqGrid("getDataIDs"),t=0;t<e.length;t++){var i=e[t];edit="<button style='height:30px;width:50px;' class='edit'>修改</button>",del="<button style='height:30px;width:50px;' class='delete'  onclick=\"jQuery('#gpsobjList').jqGrid('delGridRow','"+i+"',{url:'/gpsobj/delete',delData:{id:"+i+'},});" >删除</button>',unbind="<button style='height:30px;width:50px;' class='unbind'>解绑</button>",$("#gpsobjList").jqGrid("setRowData",e[t],{action:edit+del+unbind})}$(".edit").click(function(){var e=$(this).closest("tr").prop("id");$("#LeditNumbers").val(e),$("#edit").show(),$("#add").hide(),$("#overlay").show();var t=$("#gpsobjList").jqGrid("getRowData",e);$("#typeNum option").each(function(){$(this).text()==t.typeName&&$(this).prop("selected",!0)}),$("input:text[name='alias']").val(t.alias),$("input:radio[value="+t.state+"]").prop("checked",!0),"true"==t.state?($(".eleNumber").show(),$.get("/gps/getTagnum",function(e){$("#number").empty(),$("#number").append("<option value='1'>"+t.number+"</option>");for(var i=0;i<e.tagnum.length;i++)$("#number").append("<option value="+e.tagnum[i].id+">"+e.tagnum[i].number+"</option>")})):($("#number").empty(),$(".eleNumber").hide()),$("#formDiv").slideDown("fast")}),$(".unbind").click(function(){var e=$(this).closest("tr").prop("id");$.post("/gpsobj/unbind",{id:e},function(e){$("#gpsobjList").jqGrid("setGridParam",{url:"/gpsobj/query"}).trigger("reloadGrid")})})}}),jQuery("#gpsobjList").jqGrid("navGrid","#objPager",{edit:!1,add:!1,del:!1,search:!1}).navButtonAdd("#objPager",{caption:"添加定位对象",buttonicon:"ui-icon-add",onClickButton:function(){$("#overlay").show(),$("#edit").hide(),$("#add").show(),$("input:text").val(""),$("#number").empty(),$("input:radio[value='false']").prop("checked",!0),$(".eleNumber").hide(),$("#formDiv").slideDown("fast")},position:"last"}),jQuery("#gpsobjList").jqGrid("setGridWidth",$(".gpsobjList").width()-2,!0),jQuery("#gpsobjList").jqGrid("setGridHeight",$(window).height()-150,!0),jQuery("#gpsobjList").jqGrid("filterToolbar",{stringResult:!0,searchOnEnter:!0}),$("#cancle").click(function(){$("#formDiv").slideUp("fast"),$("#overlay").hide()}),$.get("/loctype/query",function(e){for(var t=0;t<e.loctype.length;t++)$("#typeNum").append("<option value="+e.loctype[t].typeNum+">"+e.loctype[t].typeName+"</option>")}),$("#add,#edit").click(function(){var e=$(this).prop("id");$.ajax({type:"POST",url:"/gpsobj/"+e,datatype:"json",data:$("#gpsobjForm").serialize(),success:function(e){$("#formDiv").slideUp("fast"),$("#overlay").hide(),$("#gpsobjList").jqGrid("setGridParam",{url:"/gpsobj/query"}).trigger("reloadGrid")}})}),$("input:radio").click(function(){"true"==$(this).prop("value")?($(".eleNumber").show(),$.get("/gps/getTagnum",function(e){$("#number").empty(),$("#number").append("<option value='1'>请选择需要绑定的GPS识别码</option>");for(var t=0;t<e.tagnum.length;t++)$("#number").append("<option value="+e.tagnum[t].id+">"+e.tagnum[t].number+"</option>")})):($("#number").empty(),$(".eleNumber").hide())})});