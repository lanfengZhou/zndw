$(function(){$("#eletagList").jqGrid({url:"/eletag/query",datatype:"json",colNames:["电子标签号码","电子标签别名","添加时间","编辑"],colModel:[{name:"number",index:"number",width:50,align:"center",editable:!0,editrules:{required:!0},editoptions:{readonly:!0}},{name:"alias",index:"alias",width:50,align:"center",editable:!0},{name:"insertTime",index:"insertTime",width:50,align:"center",editable:!1},{name:"action",index:"act",width:150,align:"center",sortable:!1}],jsonReader:{root:"eletag",records:"total",total:"pages"},rowNum:10,rowList:[10,20,30],pager:"#tagPager",mtype:"post",viewrecords:!0,caption:"电子标签管理",rownumbers:!0,rownumWidth:40,gridComplete:function(){for(var e=$("#eletagList").jqGrid("getDataIDs"),t=0;t<e.length;t++){var i=e[t];edit="<button style='height:30px;width:50px;' class='edit'>修改</button>",del="<button style='height:30px;width:50px;' class='delete'  onclick=\"jQuery('#eletagList').jqGrid('delGridRow','"+i+"',{url:'/eletag/delete',delData:{id:"+i+'},});" >删除</button>',$("#eletagList").jqGrid("setRowData",e[t],{action:edit+del})}$(".edit").click(function(){var e=$(this).closest("tr").prop("id");jQuery("#eletagList").jqGrid("editGridRow",e,{url:"/eletag/edit"})})}}),jQuery("#eletagList").jqGrid("navGrid","#tagPager",{edit:!1,add:!1,del:!1,search:!1}).navButtonAdd("#tagPager",{caption:"添加标签",buttonicon:"ui-icon-add",onClickButton:function(){$("#overlay").show(),$("#formDiv").slideDown("fast")},position:"last"}),jQuery("#eletagList").jqGrid("setGridWidth",$(window).width()-2,!0),jQuery("#eletagList").jqGrid("setGridHeight",$(window).height()-150,!0),$("#cancle").click(function(){$("#formDiv").slideUp("fast"),$("#overlay").hide()}),$("#tagNum").blur(function(){$.post("/eletag/checkTagnum",{number:$(this).val()},function(e){"exist"==e.result?$("#tagNum").closest("div").next().show():$("#tagNum").closest("div").next().hide()})}),$("#add").click(function(){$.ajax({type:"POST",url:"/eletag/"+$(this).prop("id"),datatype:"json",data:$("#eletagForm").serialize(),success:function(e){$("#formDiv").slideUp("fast"),$("#overlay").hide(),$("#eletagList").jqGrid("setGridParam",{url:"/eletag/query"}).trigger("reloadGrid")}})})});