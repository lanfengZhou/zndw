$(function(){$("#gpsList").jqGrid({url:"/gps/query",datatype:"json",colNames:["GPS识别码","GPS识别码别名","添加时间","编辑"],colModel:[{name:"number",index:"number",width:50,align:"center",editable:!0,editrules:{required:!0},editoptions:{readonly:!0}},{name:"alias",index:"alias",width:50,align:"center",editable:!0},{name:"insertTime",index:"insertTime",width:50,align:"center",editable:!1},{name:"action",index:"act",width:150,align:"center",sortable:!1}],jsonReader:{root:"gps",records:"total",total:"pages"},rowNum:10,rowList:[10,20,30],pager:"#tagPager",mtype:"post",viewrecords:!0,caption:"GPS接收器管理",rownumbers:!0,rownumWidth:40,gridComplete:function(){for(var t=$("#gpsList").jqGrid("getDataIDs"),e=0;e<t.length;e++){var i=t[e];edit="<button style='height:30px;width:50px;' class='edit'>修改</button>",del="<button style='height:30px;width:50px;' class='delete'  onclick=\"jQuery('#gpsList').jqGrid('delGridRow','"+i+"',{url:'/gps/delete',delData:{id:"+i+'},});" >删除</button>',$("#gpsList").jqGrid("setRowData",t[e],{action:edit+del})}$(".edit").click(function(){var t=$(this).closest("tr").prop("id");jQuery("#gpsList").jqGrid("editGridRow",t,{url:"/gps/edit"})})}}),jQuery("#gpsList").jqGrid("navGrid","#tagPager",{edit:!1,add:!1,del:!1,search:!1}).navButtonAdd("#tagPager",{caption:"添加GPS",buttonicon:"ui-icon-add",onClickButton:function(){$("#overlay").show(),$("#formDiv").slideDown("fast")},position:"last"}),jQuery("#gpsList").jqGrid("setGridWidth",$(".gpsList").width()-2,!0),jQuery("#gpsList").jqGrid("setGridHeight",$(window).height()-150,!0),$("#cancle").click(function(){$("#formDiv").slideUp("fast"),$("#overlay").hide()}),$("#tagNum").blur(function(){$.post("/gps/checkTagnum",{number:$(this).val()},function(t){"exist"==t.result?$("#tagNum").closest("div").next().show():$("#tagNum").closest("div").next().hide()})}),$("#add").click(function(){$.ajax({type:"POST",url:"/gps/"+$(this).prop("id"),datatype:"json",data:$("#gpsForm").serialize(),success:function(t){$("#formDiv").slideUp("fast"),$("#overlay").hide(),$("#gpsList").jqGrid("setGridParam",{url:"/gps/query"}).trigger("reloadGrid")}})})});